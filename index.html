<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EclipseXploits Studio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        /* TODOS OS ESTILOS ANTERIORES PERMANECEM AQUI */
        /* Por quest√£o de espa√ßo, mantenho apenas os essenciais */
        
        :root {
            --primary: #6d28d9;
            --primary-dark: #5b21b6;
            --secondary: #1e293b;
            --accent: #f59e0b;
            --light: #f8fafc;
            --dark: #0f172a;
            --gray: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
            color: var(--light);
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Anti DevTools */
        #devtools-detected {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 99999;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 20px;
            flex-direction: column;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        header {
            background: rgba(15, 23, 42, 0.98);
            backdrop-filter: blur(10px);
            position: fixed;
            width: 100%;
            z-index: 1000;
            padding: 12px 0;
            border-bottom: 1px solid rgba(109, 40, 217, 0.3);
        }
        
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--light);
            text-decoration: none;
            white-space: nowrap;
        }
        
        .nav-links {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .nav-link {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            padding: 6px 10px;
            border-radius: 8px;
            transition: var(--transition);
            white-space: nowrap;
        }
        
        .user-section {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
        }
        
        .user-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }
        
        .btn {
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            font-family: 'Poppins', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            font-size: 0.9rem;
            white-space: nowrap;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: white;
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--light);
            border: 2px solid var(--primary);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        
        .modal-content {
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.98), rgba(15, 23, 42, 0.98));
            border-radius: 15px;
            width: 100%;
            max-width: 400px;
            padding: 25px;
            position: relative;
        }
        
        /* ... resto dos estilos ... */
    </style>
</head>
<body>
    <!-- Anti DevTools -->
    <div id="devtools-detected">
        <h2><i class="fas fa-skull-crossbones"></i> Tentativa de Acesso Detectada</h2>
        <p>Voc√™ foi pego tentando visualizar a source do site!</p>
        <button id="closeDevtoolsWarning" class="btn btn-primary" style="margin-top: 20px;">
            <i class="fas fa-times"></i> Fechar
        </button>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <a href="#" class="logo">
                    <i class="fas fa-meteor"></i>
                    EclipseXploits
                </a>
                
                <div class="nav-links">
                    <a href="#home" class="nav-link">Home</a>
                    <a href="#scripts" class="nav-link">Scripts</a>
                    <a href="#chat" class="nav-link" id="chatLink">Chat</a>
                </div>
                
                <div class="user-section">
                    <button id="loginBtn" class="btn btn-secondary">Login</button>
                    <div id="userAvatar" class="user-avatar" style="display: none;"></div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main style="padding-top: 80px;">
        <section id="home" class="hero">
            <div class="container">
                <h1>EclipseXploits Studio</h1>
                <p>Scripts premium e automa√ß√µes de alta performance</p>
                <button id="getStartedBtn" class="btn btn-primary">
                    <i class="fas fa-rocket"></i> Come√ßar
                </button>
            </div>
        </section>

        <section id="scripts" style="padding: 40px 0;">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 30px; font-size: 1.8rem;">Scripts</h2>
                <div id="scriptsList" style="display: grid; gap: 20px;"></div>
                
                <div id="adminPanel" style="display: none; margin-top: 40px; padding: 20px; background: rgba(30,41,59,0.8); border-radius: 10px;">
                    <h3 style="color: var(--accent); margin-bottom: 20px;">Painel Admin</h3>
                    <button id="addScriptBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Novo Script
                    </button>
                </div>
            </div>
        </section>

        <section id="chatSection" style="display: none; padding: 40px 0;">
            <div class="container">
                <h2 style="text-align: center; margin-bottom: 30px; font-size: 1.8rem;">Chat</h2>
                <div style="background: rgba(30,41,59,0.8); border-radius: 10px; padding: 20px;">
                    <div id="chatMessages" style="height: 300px; overflow-y: auto; margin-bottom: 20px; padding: 10px; background: rgba(15,23,42,0.5); border-radius: 8px;"></div>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="chatInput" style="flex: 1; padding: 10px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(109,40,217,0.3); color: white;" placeholder="Digite sua mensagem...">
                        <button id="sendMessageBtn" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeModal">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px;">Login</h2>
            <div id="errorMessage" style="display: none; background: rgba(239,68,68,0.1); color: #ef4444; padding: 10px; border-radius: 8px; margin-bottom: 15px;"></div>
            <form id="loginForm">
                <input type="email" id="email" placeholder="Email" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(100,116,139,0.3); color: white;">
                <input type="password" id="password" placeholder="Senha" style="width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(100,116,139,0.3); color: white;">
                <button type="submit" class="btn btn-primary" style="width: 100%;">Entrar</button>
                <p style="text-align: center; margin-top: 15px; font-size: 0.9rem;">
                    <a href="#" id="switchToRegister" style="color: var(--primary);">Criar conta</a>
                </p>
            </form>
        </div>
    </div>

    <!-- Add Script Modal -->
    <div id="addScriptModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeScriptModal">&times;</span>
            <h2 style="text-align: center; margin-bottom: 20px;">Novo Script</h2>
            <form id="addScriptForm">
                <input type="text" id="scriptTitle" placeholder="T√≠tulo" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(100,116,139,0.3); color: white;">
                <textarea id="scriptDescription" placeholder="Descri√ß√£o" rows="3" style="width: 100%; padding: 12px; margin-bottom: 15px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(100,116,139,0.3); color: white;"></textarea>
                <textarea id="scriptCode" placeholder="C√≥digo" rows="5" style="width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 8px; background: rgba(15,23,42,0.8); border: 1px solid rgba(100,116,139,0.3); color: white;"></textarea>
                <button type="submit" class="btn btn-primary" style="width: 100%;">Publicar Script</button>
            </form>
        </div>
    </div>

    <script>
        // ==============================================
        // FIREBASE CONFIGURATION
        // ==============================================
        const firebaseConfig = {
            apiKey: "AIzaSyCeAkDlLb3cAnYQvpo2BwHSB8qktUq7Zbg",
            authDomain: "eclipsexploits.firebaseapp.com",
            databaseURL: "https://eclipsexploits-default-rtdb.firebaseio.com",
            projectId: "eclipsexploits",
            storageBucket: "eclipsexploits.firebasestorage.app",
            messagingSenderId: "126850895726",
            appId: "1:126850895726:web:94e544d9f2d373671abb7f",
            measurementId: "G-LH6C7CXH10"
        };

        // Inicializar Firebase
        let app;
        try {
            app = firebase.initializeApp(firebaseConfig);
            console.log("‚úÖ Firebase inicializado!");
        } catch (error) {
            console.error("‚ùå Erro Firebase:", error);
            alert("Erro ao conectar com Firebase. Verifique sua conex√£o.");
        }

        const auth = firebase.auth();
        const database = firebase.database();

        // ==============================================
        // VARI√ÅVEIS GLOBAIS
        // ==============================================
        let currentUser = null;
        let isAdmin = false;
        let isLoginMode = true;

        // ==============================================
        // ELEMENTOS DOM
        // ==============================================
        const elements = {
            loginBtn: document.getElementById('loginBtn'),
            userAvatar: document.getElementById('userAvatar'),
            loginModal: document.getElementById('loginModal'),
            closeModal: document.getElementById('closeModal'),
            errorMessage: document.getElementById('errorMessage'),
            loginForm: document.getElementById('loginForm'),
            switchToRegister: document.getElementById('switchToRegister'),
            getStartedBtn: document.getElementById('getStartedBtn'),
            scriptsList: document.getElementById('scriptsList'),
            adminPanel: document.getElementById('adminPanel'),
            addScriptBtn: document.getElementById('addScriptBtn'),
            addScriptModal: document.getElementById('addScriptModal'),
            closeScriptModal: document.getElementById('closeScriptModal'),
            addScriptForm: document.getElementById('addScriptForm'),
            chatLink: document.getElementById('chatLink'),
            chatSection: document.getElementById('chatSection'),
            chatMessages: document.getElementById('chatMessages'),
            chatInput: document.getElementById('chatInput'),
            sendMessageBtn: document.getElementById('sendMessageBtn')
        };

        // ==============================================
        // INICIALIZA√á√ÉO
        // ==============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log("‚úÖ DOM carregado");
            
            // Setup listeners
            setupEventListeners();
            
            // Verificar autentica√ß√£o
            checkAuthState();
            
            // Carregar scripts
            loadScripts();
            
            // Iniciar chat
            loadChat();
            
            // Setup anti-devtools
            setupAntiDevTools();
        });

        // ==============================================
        // EVENT LISTENERS
        // ==============================================
        function setupEventListeners() {
            console.log("üîß Configurando listeners...");
            
            // Login button
            elements.loginBtn.addEventListener('click', function() {
                console.log("üì± Abrindo modal de login");
                elements.loginModal.style.display = 'flex';
            });
            
            // Close modal
            elements.closeModal.addEventListener('click', function() {
                elements.loginModal.style.display = 'none';
            });
            
            elements.closeScriptModal.addEventListener('click', function() {
                elements.addScriptModal.style.display = 'none';
            });
            
            // Login form
            elements.loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                handleAuthSubmit();
            });
            
            // Switch between login/register
            elements.switchToRegister.addEventListener('click', function(e) {
                e.preventDefault();
                toggleAuthMode();
            });
            
            // Get started button
            elements.getStartedBtn.addEventListener('click', function() {
                document.getElementById('scripts').scrollIntoView({ behavior: 'smooth' });
            });
            
            // Chat link
            elements.chatLink.addEventListener('click', function(e) {
                e.preventDefault();
                toggleChat();
            });
            
            // Add script button
            elements.addScriptBtn.addEventListener('click', function() {
                if (isAdmin) {
                    elements.addScriptModal.style.display = 'flex';
                }
            });
            
            // Add script form
            elements.addScriptForm.addEventListener('submit', function(e) {
                e.preventDefault();
                addNewScript();
            });
            
            // Send message
            elements.sendMessageBtn.addEventListener('click', sendMessage);
            elements.chatInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
            
            // Close modals on outside click
            window.addEventListener('click', function(e) {
                if (e.target === elements.loginModal) {
                    elements.loginModal.style.display = 'none';
                }
                if (e.target === elements.addScriptModal) {
                    elements.addScriptModal.style.display = 'none';
                }
            });
        }

        // ==============================================
        // AUTENTICA√á√ÉO
        // ==============================================
        function checkAuthState() {
            console.log("üîç Verificando estado de autentica√ß√£o...");
            
            auth.onAuthStateChanged(async function(user) {
                if (user) {
                    console.log("‚úÖ Usu√°rio logado:", user.email);
                    currentUser = user;
                    
                    // Atualizar UI
                    updateUIForLoggedInUser(user);
                    
                    // Verificar se √© admin
                    await checkAdminStatus(user.uid);
                    
                    // Carregar scripts do admin
                    if (isAdmin) {
                        loadAdminScripts();
                    }
                } else {
                    console.log("üö™ Usu√°rio n√£o logado");
                    currentUser = null;
                    updateUIForGuest();
                }
            });
        }

        async function checkAdminStatus(userId) {
            try {
                const snapshot = await database.ref('admins/' + userId).once('value');
                if (snapshot.exists() && snapshot.val() === true) {
                    isAdmin = true;
                    elements.adminPanel.style.display = 'block';
                    console.log("üëë Usu√°rio √© admin");
                } else if (currentUser && currentUser.email === 'guizinbzsk@gmail.com') {
                    // Se for o email do dono, garantir admin
                    await database.ref('admins/' + userId).set(true);
                    isAdmin = true;
                    elements.adminPanel.style.display = 'block';
                    console.log("üëë Email do dono detectado, configurando como admin");
                }
            } catch (error) {
                console.error("‚ùå Erro ao verificar admin:", error);
            }
        }

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            const submitBtn = elements.loginForm.querySelector('button[type="submit"]');
            const switchLink = elements.switchToRegister;
            
            if (isLoginMode) {
                submitBtn.textContent = 'Entrar';
                switchLink.textContent = 'Criar conta';
            } else {
                submitBtn.textContent = 'Criar Conta';
                switchLink.textContent = 'J√° tem conta? Entrar';
            }
            
            elements.errorMessage.style.display = 'none';
        }

        function handleAuthSubmit() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            console.log("üîê Tentando autentica√ß√£o:", email);
            
            if (isLoginMode) {
                // Login
                auth.signInWithEmailAndPassword(email, password)
                    .then(function(userCredential) {
                        console.log("‚úÖ Login bem-sucedido");
                        elements.loginModal.style.display = 'none';
                        showNotification('Login realizado!', 'success');
                        elements.loginForm.reset();
                    })
                    .catch(function(error) {
                        console.error("‚ùå Erro no login:", error);
                        showAuthError(error);
                    });
            } else {
                // Registro
                auth.createUserWithEmailAndPassword(email, password)
                    .then(function(userCredential) {
                        console.log("‚úÖ Registro bem-sucedido");
                        elements.loginModal.style.display = 'none';
                        showNotification('Conta criada com sucesso!', 'success');
                        elements.loginForm.reset();
                    })
                    .catch(function(error) {
                        console.error("‚ùå Erro no registro:", error);
                        showAuthError(error);
                    });
            }
        }

        function showAuthError(error) {
            let message = 'Erro desconhecido';
            
            switch(error.code) {
                case 'auth/invalid-email':
                    message = 'Email inv√°lido';
                    break;
                case 'auth/user-disabled':
                    message = 'Conta desativada';
                    break;
                case 'auth/user-not-found':
                    message = 'Usu√°rio n√£o encontrado';
                    break;
                case 'auth/wrong-password':
                    message = 'Senha incorreta';
                    break;
                case 'auth/email-already-in-use':
                    message = 'Email j√° cadastrado';
                    break;
                case 'auth/weak-password':
                    message = 'Senha muito fraca (m√≠nimo 6 caracteres)';
                    break;
                case 'auth/network-request-failed':
                    message = 'Erro de conex√£o. Verifique sua internet.';
                    break;
                default:
                    message = error.message;
            }
            
            elements.errorMessage.textContent = message;
            elements.errorMessage.style.display = 'block';
        }

        // ==============================================
        // UI FUNCTIONS
        // ==============================================
        function updateUIForLoggedInUser(user) {
            console.log("üé® Atualizando UI para usu√°rio logado");
            
            // Esconder bot√£o de login
            elements.loginBtn.style.display = 'none';
            
            // Mostrar avatar
            elements.userAvatar.style.display = 'flex';
            elements.userAvatar.textContent = user.email.charAt(0).toUpperCase();
            elements.userAvatar.title = user.email;
            
            // Ativar chat
            elements.chatInput.disabled = false;
            elements.chatInput.placeholder = "Digite sua mensagem...";
            elements.sendMessageBtn.disabled = false;
            
            // Configurar logout no avatar
            elements.userAvatar.onclick = function() {
                if (confirm('Deseja sair da sua conta?')) {
                    auth.signOut();
                    showNotification('Logout realizado!', 'info');
                }
            };
        }

        function updateUIForGuest() {
            console.log("üé® Atualizando UI para visitante");
            
            // Mostrar bot√£o de login
            elements.loginBtn.style.display = 'block';
            
            // Esconder avatar
            elements.userAvatar.style.display = 'none';
            
            // Esconder painel admin
            elements.adminPanel.style.display = 'none';
            
            // Desativar chat
            elements.chatInput.disabled = true;
            elements.chatInput.placeholder = "Fa√ßa login para usar o chat";
            elements.sendMessageBtn.disabled = true;
        }

        function toggleChat() {
            if (!currentUser) {
                showNotification('Fa√ßa login para acessar o chat', 'warning');
                elements.loginModal.style.display = 'flex';
                return;
            }
            
            // Esconder outras se√ß√µes
            document.getElementById('home').style.display = 'none';
            document.getElementById('scripts').style.display = 'none';
            
            // Mostrar chat
            elements.chatSection.style.display = 'block';
            elements.chatInput.focus();
        }

        // ==============================================
        // SCRIPTS FUNCTIONS
        // ==============================================
        function loadScripts() {
            console.log("üì• Carregando scripts...");
            
            database.ref('scripts').orderByChild('date').limitToLast(20).once('value')
                .then(function(snapshot) {
                    console.log("üì¶ Scripts recebidos:", snapshot.numChildren());
                    
                    elements.scriptsList.innerHTML = '';
                    
                    if (!snapshot.exists()) {
                        elements.scriptsList.innerHTML = '<p style="text-align: center; color: var(--gray);">Nenhum script dispon√≠vel ainda.</p>';
                        return;
                    }
                    
                    snapshot.forEach(function(childSnapshot) {
                        const script = childSnapshot.val();
                        script.id = childSnapshot.key;
                        
                        // Mostrar apenas scripts publicados para n√£o-admins
                        if (script.published !== false || isAdmin) {
                            const scriptCard = createScriptCard(script);
                            elements.scriptsList.appendChild(scriptCard);
                        }
                    });
                })
                .catch(function(error) {
                    console.error("‚ùå Erro ao carregar scripts:", error);
                    elements.scriptsList.innerHTML = '<p style="text-align: center; color: var(--danger);">Erro ao carregar scripts.</p>';
                });
        }

        function loadAdminScripts() {
            if (!isAdmin) return;
            
            database.ref('scripts').once('value')
                .then(function(snapshot) {
                    // Pode fazer algo espec√≠fico para admin aqui
                    console.log("üëë Admin: Total de scripts:", snapshot.numChildren());
                });
        }

        function createScriptCard(script) {
            const div = document.createElement('div');
            div.className = 'script-card';
            div.style.cssText = 'background: rgba(30,41,59,0.7); border-radius: 10px; padding: 20px; border: 1px solid rgba(109,40,217,0.2);';
            
            const date = new Date(script.date);
            const dateStr = date.toLocaleDateString('pt-BR');
            
            let actions = '';
            if (isAdmin) {
                actions = `
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button onclick="downloadScript('${script.id}')" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.9rem;">
                            <i class="fas fa-download"></i> Baixar
                        </button>
                        <button onclick="toggleScriptPublish('${script.id}', ${script.published !== false})" class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;">
                            ${script.published !== false ? 'Despublicar' : 'Publicar'}
                        </button>
                        <button onclick="deleteScript('${script.id}')" class="btn" style="padding: 8px 16px; font-size: 0.9rem; background: var(--danger); color: white;">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
            } else {
                actions = `
                    <div style="display: flex; gap: 10px; margin-top: 15px;">
                        <button onclick="downloadScript('${script.id}')" class="btn btn-primary" style="padding: 8px 16px; font-size: 0.9rem;">
                            <i class="fas fa-download"></i> Baixar
                        </button>
                        <button onclick="copyScript('${script.id}')" class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.9rem;">
                            <i class="fas fa-copy"></i> Copiar
                        </button>
                    </div>
                `;
            }
            
            div.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                    <h3 style="color: white; font-size: 1.2rem;">${script.title || 'Sem t√≠tulo'}</h3>
                    <span style="color: var(--gray); font-size: 0.9rem; background: rgba(30,41,59,0.9); padding: 4px 8px; border-radius: 6px;">${dateStr}</span>
                </div>
                <p style="color: var(--gray); margin-bottom: 15px; line-height: 1.5;">${script.description || 'Sem descri√ß√£o'}</p>
                <p style="color: var(--gray); font-size: 0.9rem; margin-bottom: 10px;">
                    <i class="fas fa-user"></i> ${script.author || 'Autor desconhecido'}
                </p>
                ${actions}
            `;
            
            return div;
        }

        function addNewScript() {
            if (!isAdmin) return;
            
            const title = document.getElementById('scriptTitle').value;
            const description = document.getElementById('scriptDescription').value;
            const code = document.getElementById('scriptCode').value;
            
            if (!title || !code) {
                showNotification('Preencha t√≠tulo e c√≥digo do script', 'warning');
                return;
            }
            
            const scriptData = {
                title: title,
                description: description,
                code: code,
                date: Date.now(),
                published: true,
                author: currentUser.email,
                authorId: currentUser.uid
            };
            
            database.ref('scripts').push(scriptData)
                .then(function() {
                    console.log("‚úÖ Script adicionado com sucesso");
                    elements.addScriptModal.style.display = 'none';
                    elements.addScriptForm.reset();
                    showNotification('Script publicado!', 'success');
                    loadScripts();
                })
                .catch(function(error) {
                    console.error("‚ùå Erro ao adicionar script:", error);
                    showNotification('Erro ao publicar script: ' + error.message, 'error');
                });
        }

        // ==============================================
        // SCRIPT ACTIONS
        // ==============================================
        window.downloadScript = function(scriptId) {
            if (!currentUser) {
                showNotification('Fa√ßa login para baixar scripts', 'warning');
                elements.loginModal.style.display = 'flex';
                return;
            }
            
            database.ref('scripts/' + scriptId).once('value')
                .then(function(snapshot) {
                    const script = snapshot.val();
                    const blob = new Blob([script.code], { type: 'text/plain' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = (script.title || 'script') + '.lua';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                    
                    showNotification('Download iniciado!', 'success');
                })
                .catch(function(error) {
                    showNotification('Erro ao baixar script', 'error');
                });
        };

        window.copyScript = function(scriptId) {
            database.ref('scripts/' + scriptId).once('value')
                .then(function(snapshot) {
                    const script = snapshot.val();
                    navigator.clipboard.writeText(script.code)
                        .then(function() {
                            showNotification('C√≥digo copiado!', 'success');
                        })
                        .catch(function() {
                            showNotification('Erro ao copiar c√≥digo', 'error');
                        });
                });
        };

        window.toggleScriptPublish = function(scriptId, currentStatus) {
            if (!isAdmin) return;
            
            database.ref('scripts/' + scriptId + '/published').set(!currentStatus)
                .then(function() {
                    showNotification(`Script ${!currentStatus ? 'publicado' : 'despublicado'}!`, 'success');
                    loadScripts();
                });
        };

        window.deleteScript = function(scriptId) {
            if (!isAdmin) return;
            
            if (confirm('Tem certeza que deseja excluir este script?')) {
                database.ref('scripts/' + scriptId).remove()
                    .then(function() {
                        showNotification('Script exclu√≠do!', 'success');
                        loadScripts();
                    });
            }
        };

        // ==============================================
        // CHAT FUNCTIONS
        // ==============================================
        function loadChat() {
            database.ref('chat').limitToLast(50).on('value', function(snapshot) {
                elements.chatMessages.innerHTML = '';
                
                if (!snapshot.exists()) {
                    elements.chatMessages.innerHTML = '<p style="text-align: center; color: var(--gray);">Nenhuma mensagem ainda.</p>';
                    return;
                }
                
                const messages = [];
                snapshot.forEach(function(childSnapshot) {
                    messages.push({
                        id: childSnapshot.key,
                        ...childSnapshot.val()
                    });
                });
                
                // Ordenar por timestamp
                messages.sort(function(a, b) {
                    return a.timestamp - b.timestamp;
                });
                
                // Mostrar mensagens
                messages.forEach(function(message) {
                    const messageElement = createChatMessage(message);
                    elements.chatMessages.appendChild(messageElement);
                });
                
                // Scroll para baixo
                elements.chatMessages.scrollTop = elements.chatMessages.scrollHeight;
            });
        }

        function createChatMessage(message) {
            const isCurrentUser = currentUser && message.userId === currentUser.uid;
            const time = new Date(message.timestamp);
            const timeStr = time.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
            
            const div = document.createElement('div');
            div.style.cssText = `
                margin-bottom: 15px;
                display: flex;
                ${isCurrentUser ? 'justify-content: flex-end;' : 'justify-content: flex-start;'}
                align-items: flex-start;
                gap: 10px;
            `;
            
            const avatar = `
                <div style="
                    width: 32px;
                    height: 32px;
                    border-radius: 50%;
                    background: linear-gradient(45deg, var(--primary), var(--accent));
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: 600;
                    font-size: 0.9rem;
                    flex-shrink: 0;
                ">
                    ${message.userName ? message.userName.charAt(0).toUpperCase() : 'U'}
                </div>
            `;
            
            const content = `
                <div style="
                    background: ${isCurrentUser ? 'rgba(109,40,217,0.2)' : 'rgba(30,41,59,0.8)'};
                    border-radius: 10px;
                    padding: 10px 15px;
                    max-width: 70%;
                    border: 1px solid ${isCurrentUser ? 'rgba(109,40,217,0.3)' : 'rgba(100,116,139,0.3)'};
                ">
                    <div style="
                        font-weight: 600;
                        color: ${isCurrentUser ? 'var(--accent)' : 'white'};
                        margin-bottom: 5px;
                        font-size: 0.9rem;
                    ">
                        ${message.userName || 'Usu√°rio'} ${isCurrentUser ? '(Voc√™)' : ''}
                    </div>
                    <div style="color: white; font-size: 0.95rem; word-break: break-word;">
                        ${message.text}
                    </div>
                    <div style="
                        color: var(--gray);
                        font-size: 0.75rem;
                        margin-top: 5px;
                        text-align: right;
                    ">
                        ${timeStr}
                    </div>
                </div>
            `;
            
            if (isCurrentUser) {
                div.innerHTML = content + avatar;
            } else {
                div.innerHTML = avatar + content;
            }
            
            return div;
        }

        function sendMessage() {
            const text = elements.chatInput.value.trim();
            if (!text || !currentUser) return;
            
            const messageData = {
                text: text,
                timestamp: Date.now(),
                userId: currentUser.uid,
                userName: currentUser.email.split('@')[0],
                isAdmin: isAdmin
            };
            
            database.ref('chat').push(messageData)
                .then(function() {
                    elements.chatInput.value = '';
                    elements.chatInput.focus();
                })
                .catch(function(error) {
                    console.error("‚ùå Erro ao enviar mensagem:", error);
                    showNotification('Erro ao enviar mensagem', 'error');
                });
        }

        // ==============================================
        // ANTI-DEVTOOLS PROTECTION
        // ==============================================
        function setupAntiDevTools() {
            // Detect F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
            document.addEventListener('keydown', function(e) {
                if (
                    e.key === 'F12' ||
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                    (e.ctrlKey && e.key === 'U')
                ) {
                    e.preventDefault();
                    showDevToolsWarning();
                }
            });
            
            // Disable right click
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
            });
            
            // Detect devtools open
            const devToolsCheck = setInterval(function() {
                const widthThreshold = window.outerWidth - window.innerWidth > 160;
                const heightThreshold = window.outerHeight - window.innerHeight > 160;
                
                if (widthThreshold || heightThreshold) {
                    showDevToolsWarning();
                    clearInterval(devToolsCheck);
                }
            }, 1000);
        }

        function showDevToolsWarning() {
            const warningDiv = document.getElementById('devtools-detected');
            warningDiv.style.display = 'flex';
            
            // Close button
            document.getElementById('closeDevtoolsWarning').onclick = function() {
                warningDiv.style.display = 'none';
            };
            
            // Log the attempt
            if (currentUser) {
                database.ref('security_logs').push({
                    userId: currentUser.uid,
                    email: currentUser.email,
                    action: 'devtools_attempt',
                    timestamp: Date.now(),
                    userAgent: navigator.userAgent
                });
            }
        }

        // ==============================================
        // HELPER FUNCTIONS
        // ==============================================
        function showNotification(message, type) {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification-toast');
            existingNotifications.forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = 'notification-toast';
            notification.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                font-weight: 500;
                z-index: 3000;
                background: ${type === 'success' ? 'var(--success)' : 
                           type === 'error' ? 'var(--danger)' : 
                           type === 'warning' ? 'var(--warning)' : 'var(--primary)'};
                box-shadow: 0 5px 20px rgba(0,0,0,0.3);
                max-width: 300px;
                word-break: break-word;
                animation: slideIn 0.3s ease;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 
                                   type === 'error' ? 'exclamation-circle' : 
                                   type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            // Auto remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }

        // Add CSS for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @keyframes slideOut {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(100%);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // ==============================================
        // NAVIGATION
        // ==============================================
        // Logo click - go home
        document.querySelector('.logo').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('home').style.display = 'block';
            document.getElementById('scripts').style.display = 'block';
            elements.chatSection.style.display = 'none';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Nav links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                if (this.getAttribute('href') === '#home') {
                    e.preventDefault();
                    document.getElementById('home').style.display = 'block';
                    document.getElementById('scripts').style.display = 'block';
                    elements.chatSection.style.display = 'none';
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else if (this.getAttribute('href') === '#scripts') {
                    e.preventDefault();
                    document.getElementById('home').style.display = 'block';
                    document.getElementById('scripts').style.display = 'block';
                    elements.chatSection.style.display = 'none';
                    document.getElementById('scripts').scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        console.log("üöÄ Aplica√ß√£o inicializada com sucesso!");
    </script>
</body>
</html>
